# Escobar bot
Paket ismi **com.escobar.pablo** olarak bilinen Android bankacılık zararlısı , cihazın kullanıcı arayüzünü ele geçirmek için Android Erişilebilirlik Servisini (Accessibility Service diğer bir değişle a11y) kötüye kullanmaktadır. Erişilebilirlik Servisi, engeli olan insanlara yardım amaçlı geliştirilen, cihaz üzerinde kullanıcı adına butona tıklama gibi arayüz işlemlerini gerçekleştirebilir. Android zararlısı, cihaz üzerinde çoğunlukla bankacılık uygulamalarını hedef almakta ve a11y sayesinde çalışan uygulama bilgisini öğrenerek hedeflenen uygulamanın açılmasıyla beraber cihaz ekranına klone bir giriş sayfası getirmektedir. Araştırmacıların yaptığı çalışmalara göre Escobar trojan zararlısının [Aberebot](Aberebot.md) yeni varyantı olduğu tespit edilmiştir. Kimlik avı overlay saldırıları ile kullanıcı bilgilerini ele geçirmenin yanı sıra yeni sürümle beraber Google Authenticator üzerinden veri okuma, VNC (virtual network computing) ile cihaz ekranını uzaktan yönetme gibi yetenekleri bulunmaktadır. Darkweb forumlarında da detaylı özellikleri paylaşılmaktadır.

Yapılan teknik analizler incelendiğinde Escobar zararlısı, McAfee.apk olarak antivirüs yazılımını taklit etmekte olduğu bilinmektedir. Manifest içerisinde yaklşık 15 kritik kullanıcı izni bulunmaktadır. Bunlar:
	- READ_SMS, RECEIVE_SMS,SEND_SMS, WRITE_SMS
	- READ_CALL_LOG, READ_CONTACTS
	- READ_PHONE_STATE
	- RECORD_AUDIO
	- CALL_PHONE
	- GET_ACCOUNTS
	- DISABLE_KEYGUARD
	- READ/WRITE_EXTERNAL_STORAGE
	- ACCESS_{FINE| COARSE}\_LOCATION

Cihaz bilgilerini toplayarak komuta kontrol sunucuna göndermektedir.SMSler, çağrı geçmişi, konum bilgisi, API keyleri, ses kayıtları, 2fa kodu ve hatta kullanıcı dosyaları gibi bilgileri toplamaktadır. Komuta kontrol sunucusunun gönderdiği komutlara göre işlevleri gerçekleştirir. Zararlı kendini imha edecek "Kill Bot" komutuna da sahip olduğu yapılan analizlerde tespit edilmiştir.

## Özellikleri ve İşlevleri
Uygulama ilk başlatıldığı zaman cihazın emülator mü ya da gerçek bir cihaz olup olmadığını kontrol etmektedir. Koşulların sağlanmadığı durumda uygulama başlatılmamaktadır. Erişilebilirlik servisine erişimi onaylandığı zaman, farklı biraktivite başlatarak arka planda dineleyicileri çalıştırır ve VNC servisini başaltır. Google Play Store tarama servisini de durdurmakta olduğu söyleniyor.


## MITRE ATTACK Matirisi
Taktikler 
- Initial Access
	- T1444 - meşru uygulama kılığına girme
	- T1476 - uygulama mağaza dışından iletilme
- Execution
	- T1575 - Native Kod
- Collection
	- T1412 - SMS mesajlara erişim
	- T1429 - Ses kaydı alma
	- T1430 - Konum takibi
	- T1432 - telefon rehberine erişim
	- T1433 - çağrı geçmiş erişimi
	- T1512 - Kamera kontrolü
	- T1533 - sistemden veri alma
- Command&Control
	- T1436 - C2 iletişimlerinde yaygın portları kullanma

## IOC bulguları
**Escobar APK**
- SHA256: a9d1561ed0d23a5473d68069337e2f8e7862f7b72b74251eb63ccc883ba9459f
- SHA1: a9d1561ed0d23a5473d68069337e2f8e7862f7b72b74251eb63ccc883ba9459f
- MD5: d57e1c11f915b874ef5c86cedb25abda

# Kaynak
- [Dissecting the Escobar Bot](https://valsamaras.medium.com/escobars-bot-post-mortem-b6221196d6a4)
- [AbereBot Returns As Escobar](https://blog.cyble.com/2022/03/10/aberebot-returns-as-escobar/)
- https://twitter.com/malwrhunterteam/status/1499390775775293454
- https://hothardware.com/news/escobar-banking-trojan-targets-mfa-codes
